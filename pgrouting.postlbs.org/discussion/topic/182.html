<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

  
  

  


  

  
<!-- Mirrored from pgrouting.postlbs.org/discussion/topic/182 by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 20 Nov 2010 01:59:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
    <title>
      Message List – pgRouting
    </title>
        <link rel="search" href="../../search.html" />
        <link rel="help" href="../../wiki/TracGuide.html" />
        <link rel="start" href="../../wiki.html" />
        <link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../chrome/discussion/css/discussion.css" type="text/css" /><link rel="stylesheet" href="../../chrome/discussion/css/admin.css" type="text/css" />
        <link rel="shortcut icon" href="../../chrome/site/pgRouting.ico" type="image/x-icon" />
        <link rel="icon" href="../../chrome/site/pgRouting.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../../search/opensearchhtml.html" title="Search pgRouting" />
    <script type="text/javascript" src="../../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../../chrome/common/js/trac.js"></script><script type="text/javascript" src="../../chrome/common/js/search.js"></script><script type="text/javascript" src="../../chrome/common/js/wikitoolbar.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      $(document).ready(function() {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor("Link to this section");
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../../chrome/site/css/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="../../index.html"><img src="../../chrome/site/slonik2_11.gif" alt="" height="126" /></a>
      </div>
      <form id="search" action="http://pgrouting.postlbs.org/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../../login.html">Login</a></li><li><a href="../../prefs.html">Preferences</a></li><li class="last"><a href="../../register.html">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../../wiki.html">Home</a></li><li><a href="../../timeline.html">Timeline</a></li><li><a href="../../roadmap.html">Roadmap</a></li><li><a href="../../browser.html">Browse Source</a></li><li><a href="../../report.html">View Tickets</a></li><li><a href="../../search.html">Search</a></li><li class="last active"><a href="../../discussion.html">Forum</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="../../discussion.html">Forum Index</a></li><li class="last"><a href="../forum/23.html" title="data">data</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="discussion searchable">
      <div id="message-list" class="message-list">
        <h1>data (#23) - How to convert x/y coordinate to lat/long cooordinate? (#182) - Message List</h1>
      <div class="topic new">
        <a name="topic"></a>
        <div class="header">
            <div class="subject">
              How to convert x/y coordinate to lat/long cooordinate?
            </div>
            <div class="body">
              <p>
Hi everybody.
</p>
<p>
I'm new to pgRouting. I have a project concerns to shorstest path. I use fridastreets with postgis and pgrouting. it work. But i work with desktop application( not web with WMS4W). And I want to convert x/y coordinate data of fridastreet to lat/long coordinate to display firda map with my Gis library(it only supports lat/long coordianate). Are there a formula or funtionce to do it?
</p>
<p>
I would appreciate your help.
</p>
<p>
Regards
</p>
            </div>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/11/08 13:10:24 (2 years ago)
          </div>
        </div>
      </div>
      <div class="replies new">
    <div class="set-display">
      Tree View
      <a href="http://pgrouting.postlbs.org/discussion/topic/182?discussion_action=set-display;display=flat-desc#topic">Flat View (newer first)</a>
      <a href="http://pgrouting.postlbs.org/discussion/topic/182?discussion_action=set-display;display=flat-asc#topic">Flat View (older first)</a>
    </div>
        <ul class="reply">
    <li class="new">
        <a name="message632"></a>
        <div class="id">
          Message #632
        </div>
        <div class="body">
            <p>
Hi,
</p>
<p>
What is wrong with x/y coordinates? I'm not familiar with FRIDA data, but I think it is in one of standard projections. Can you please point me to any documentation of that data format or just tell me how x/y values look like?
</p>
<p>
One more thing - I'm going to delete the ticket you created, because it has nothing to do with pgRouting itself. For this case the forum post is enough.
</p>
<p>
Anton.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            anton
          </div>
          <div class="time">
            11/11/08 14:11:48 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message633"></a>
        <div class="id">
          Message #633
        </div>
        <div class="body">
            <p>
The x/y looks like X = 3434391.068,Y = 5794015.404 in fridastreets data table,
I use mapinfo to show "strassen-joined.shp" file , and this x, y is equivalent with latitude:52o16’33.6’’ and longtitude: 8o2’16.8’’( is it right? in WSG84). I meaned how to convert X/Y to latitude/longtitude like this.
Is there a formula or function to do it?
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/11/08 22:40:21 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message634"></a>
        <div class="id">
          Message #634
        </div>
        <div class="body">
            <p>
Hi,
</p>
<p>
It looks like normal meter-based projection. You can convert it to degree-based with transform() function of PostGIS, but for that you need to figure out your original projection EPSG code (I think it should be somewhere in the documentation). I tried to find it, but all information is in German.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            anton
          </div>
          <div class="time">
            11/12/08 11:51:05 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message635"></a>
        <div class="id">
          Message #635
        </div>
        <div class="body">
            <p>
Thanks for help but now i want to convert degree-based to meter-based projection to use with this function Distance(startpoint(the_geom), SetSRID(<a class="missing wiki">MakePoint?</a>(x,y),-1))(i have lat/long must convert to x,y for this function). How can i do it? Can i do it with transform() function of PostGIS? I don't know this function() realy well. Can you show me how to use this function?.
I think the meter-based coordinate data of frida(sample of pgrouting map data) in WSG84, it's right? And i want to convert it to lat/long in WSG84 too.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/12/08 12:20:07 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message636"></a>
        <div class="id">
          Message #636
        </div>
        <div class="body">
            <p>
Yes, you can use transform function. Please refer to the PostGIS functions documentation (<a class="ext-link" href="http://www.postgis.org/documentation/manual-1.3/ch06.html#id2915561"><span class="icon"> </span>http://www.postgis.org/documentation/manual-1.3/ch06.html#id2915561</a>). But first you need to find out the EPSG code for FRIDA data.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            anton
          </div>
          <div class="time">
            11/12/08 12:43:07 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message637"></a>
        <div class="id">
          Message #637
        </div>
        <div class="body">
            <p>
I don't know how to find th EPSG code forFRIDA data but in file .prj with frida street shape file is:
PROJCS["Transverse Mercator",GEOGCS["bessel",DATUM["Deutsches_Hauptdreiecksnetz",SPHEROID["bessel",6377397.155,299.1528128],TOWGS84[598.1,73.7,418.2,0.202,0.045,-2.455,6.70]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION<a class="missing wiki">Transverse_Mercator?</a>,PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0]]
</p>
<p>
Can we know EPSG code from this information?
If i have the EPSG code of frida. Can you show me the example to use transfrom() funtion to convert a point in  degree-based to meter-based projection?
Thanks for help!
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/13/08 01:00:04 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message638"></a>
        <div class="id">
          Message #638
        </div>
        <div class="body">
            <p>
According to the projection description, EPSG code is either 31463 or 31467.
</p>
<p>
Let's suppose it is 31467 and you want to transform it to 4326 (good old equidistant cylindrical). Then to transform the geometry you need to do:
</p>
<p>
select transform(setsrid(the_geom, 31467), 4326) from tablename;
</p>
<p>
But if you have only coordinate values, first you need to make a geometry, then transform it and only then get coordinates:
</p>
<table class="wiki">
<tr></td></tr></table>
<p>
select x(transform(setsrid(geometryfromtext('POINT('<td>x</td><td>' '</td><td>y</td><td>')'), 31467), 4326)), y(transform(setsrid(geometryfromtext('POINT('</td><td>x</td><td>' '</td><td>y</td><td>')'), 31467), 4326)) from tablename;
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            anton
          </div>
          <div class="time">
            11/13/08 08:27:47 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message644"></a>
        <div class="id">
          Message #644
        </div>
        <div class="body">
            <p>
I did what you said, it's ok.
Thanks!
But I have another problem need your help.
How can i get the shortest path distance between 2 any point which have only the lat/long coordinate with function:
shortest_path_astar(sql text, source_id integer, target_id integer, directed boolean, has_reverse_cost boolean).
If possible, can you show me sample?
Thanks again!
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/16/08 13:14:19 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message645"></a>
        <div class="id">
          Message #645
        </div>
        <div class="body">
            <p>
Hi,
</p>
<p>
Nice to know it works.
</p>
<p>
Do you mean you need to get a shortest path length? To calculate a length you need to calculate a shortest path first. Knowing coordinates you can get node id values (source_id and target_id). Here is a query that can give you some clue how it works:
</p>
<p>
SELECT gid, source, target, the_geom, distance(the_geom, <a class="missing wiki">GeometryFromText?</a>( 'POINT(-66.807175 10.493085)', 54004)) AS dist FROM ccsroad WHERE the_geom &amp;&amp; setsrid( 'BOX3D(-66.907175 10.393085, -66.707175 10.593085)'::box3d, 54004) ORDER BY dist LIMIT 1
</p>
<p>
Here is an example of the way how you can get a number of edges and a length of the shortest path - <a href="../../wiki/SQLTipsAndTricks.html">http://pgrouting.postlbs.org/wiki/SQLTipsAndTricks</a>.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            anton
          </div>
          <div class="time">
            11/16/08 13:45:08 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message646"></a>
        <div class="id">
          Message #646
        </div>
        <div class="body">
            <p>
I don't know your sample code claerly.
Remember I have firdaroad data with EPSG code is 31467 and to any 2 point/long coordinate(i can a point not a startpoint or endpoint of the edge) lat/long coordinate(EPSG code is 4326)because in my project i can oly get the lat/long coordinate of point, but the routing database(frida) is in meter-based coordinate). I want to get shortest path length between these point. Plese give me some more detailed sample.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/16/08 14:05:25 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message647"></a>
        <div class="id">
          Message #647
        </div>
        <div class="body">
            <p>
Exactly! Look at the query I posted here once again. It selects the first closest edge to a point we specify with a point geometry string. Knowing the closest edge you can select its source or target point (arbitrary or checking which one is closer). The only difference with your case is that it uses projection 54004. Knowing your projection EPSG code and how reproject a data with transform function you can easily change this query to be used with your data. The only unknown place might be the BOX3D part. This part construct a bounding box around given point to search for a closest edge within.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            anton
          </div>
          <div class="time">
            11/17/08 09:15:15 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message658"></a>
        <div class="id">
          Message #658
        </div>
        <div class="body">
            <p>
I know. But Can you show me a detail exmple to get the shortest path length between to point(arbitrary)if possible. I can get the closest edge of 2 point. Then what must i do to get the shortest path length? I try to use joint table sql  follow your link, but i can't use it because i don't know exactly this sql statement sentence. Once again please show me another detail exmple(after i get the closest edge of 2 point).
Regard.
PS: if i get the shortest path length from the source(or target) of one edge to source(or target) of another edge, this shortest length is apporoximate length(exact length is [distance of point to closest edge]+[the shortest lenght from these intersection point to second point]. It's right?
How can i get the exact length like that.
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            hoanglevan
          </div>
          <div class="time">
            11/20/08 22:00:36 (2 years ago)
          </div>
        </div>
      <ul class="reply">
    <li class="new">
        <a name="message659"></a>
        <div class="id">
          Message #659
        </div>
        <div class="body">
            <p>
Did you have a look at or tried one of the tutorials already? We prepared them as FOSS4G conference workshops.
</p>
<p>
There is one chapter in the <a class="wiki" href="../../wiki/WorkshopFOSS4G2008.html">2007 workshop</a>. It explains how to get the length of each road link in the result table. You just need to loop through the result then and this will be the path length. Look here: <a href="../../wiki/Workshop-RoutingQuery.html">http://pgrouting.postlbs.org/wiki/Workshop-RoutingQuery</a>
</p>
        </div>
        <div class="controls">
        </div>
        <div class="footer">
          <div class="author">
            daniel
          </div>
          <div class="time">
            11/20/08 22:21:37 (2 years ago)
          </div>
        </div>
      <ul class="reply">
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
        <li></li>
      </ul>
    </li>
          <li></li>
        </ul>
    <div class="set-display">
      Tree View
      <a href="http://pgrouting.postlbs.org/discussion/topic/182?discussion_action=set-display;display=flat-desc#topic">Flat View (newer first)</a>
      <a href="http://pgrouting.postlbs.org/discussion/topic/182?discussion_action=set-display;display=flat-asc#topic">Flat View (older first)</a>
    </div>
        
        <div class="attachments">
        </div>
      </div>
      </div>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">
        Powered by <a href="../../about.html"><strong>Trac 0.11.5rc1</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.
      </p>
      <p class="right">pgRouting is a project of PostLBS <br /><a href="http://www.postlbs.org/">http://www.postlbs.org/</a></p>
    </div>
  </body>
